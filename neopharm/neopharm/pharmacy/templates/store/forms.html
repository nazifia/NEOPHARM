{% extends 'base.html' %}
{% load humanize %}

{% block content %}

<div class="container my-4">
    <div class="card shadow">
        <div class="card-header bg-primary text-white">
            <div class="d-flex justify-content-between align-items-center">
                <h3 class="mb-0">Forms History</h3>
                <p class="mb-0">Date: {{ now|date:"F d, Y" }}</p>
            </div>
        </div>
        <div class="card-body">
            
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Form ID</th>
                            <th>Patient Name</th>
                            <th>Hospital No</th>
                            <th>Date</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for form in forms %}
                        <tr>
                            <td>{{ form.form_id }}</td>
                            <td>{{ form.buyer_name }}</td>
                            <td>{{ form.hospital_no }}</td>
                            <td>{{ form.date|date:"d/m/Y H:i" }}</td>
                            <td>â‚¦{{ form.total_amount|floatformat:2|intcomma }}</td>
                            <td>
                                <a href="{% url 'store:view_form' form.form_id %}" class="btn btn-sm btn-primary">
                                    <i class="fas fa-eye"></i> View
                                </a>
                                {% comment %} <button onclick="printForm('{{ form.form_id }}')" class="btn btn-sm btn-secondary">
                                    <i class="fas fa-print"></i> Print
                                </button> {% endcomment %}
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="6" class="text-center">No forms found</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    function printForm(formId) {
        window.open(`{% url 'store:view_form' 'FORM_ID' %}`.replace('FORM_ID', formId), '_blank');
    }
</script>
{% endblock %}

<style>
    /* Hospital header styling */
    .hospital-header {
        background-color: #f8f9fa;
        padding: 10px 0;
        border-bottom: 2px solid #007bff;
        margin-bottom: 20px;
    }

    /* Banking details styling */
    .banking-details {
        font-size: 0.85rem;
        line-height: 1.3;
    }

    /* Responsive styles */
    @media (max-width: 767.98px) {
        .d-flex.align-items-center.gap-2 {
            flex-wrap: wrap;
        }

        .d-flex.align-items-center.gap-2 strong {
            width: 100%;
            margin-bottom: 0.25rem;
        }
    }

    @media print {
        .btn, .navbar, footer {
            display: none !important;
        }
        .card {
            border: none !important;
            box-shadow: none !important;
        }
        .card-header {
            background-color: #fff !important;
            color: #000 !important;
        }
        .badge {
            border: 1px solid #666 !important;
            color: #000 !important;
            background-color: transparent !important;
        }
        .hospital-header {
            background-color: #fff !important;
            border-bottom: 2px solid #000 !important;
            margin-bottom: 15px !important;
        }
    }
</style>